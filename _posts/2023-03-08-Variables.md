---
layout: post
title:  "Variable"
date:   2023-03-08
author: Easyfun
categories: Rust
tags: [documentation,sample]
image: Rustacean.png
---

## è®Šæ•¸èˆ‡å¯è®Šæ€§

Rustæ¨å‹•ä½ èƒ½å……åˆ†åˆ©ç”¨Rustæä¾›çš„å®‰å…¨æ€§å’Œç°¡æ˜“ä¸¦è¡Œæ€§ä¾†å¯«ç¨‹å¼çš„æ–¹æ³•ä¹‹ä¸€ã€‚

ç•¶ä¸€å€‹è®Šæ•¸æ˜¯ä¸å¯è®Šçš„ï¼Œåªè¦æœ‰æ•¸å€¼ç¶å®šåœ¨ä¸€å€‹åå­—ä¸Šï¼Œä½ å°±ç„¡æ³•æ”¹è®Šå…¶å€¼ã€‚


## è®Šæ•¸ç¶å®š

åœ¨Rustä¸­æˆ‘å€‘æœƒ:

let a = "hello" ï¼ŒåŒæ™‚ç¨±ä½œè®Šæ•¸ç¶å®š

## è®Šæ•¸å¯è®Šæ€§
{% highlight rust %}

fn main() {
    let x = 1;
    println!("The value of x is: {}", x);
    x = 2;
    println!("The value of x is: {}", x);
}

{% endhighlight %}

åŸ·è¡Œå¾Œ
```
error[E0384]: cannot assign twice to immutable variable `x`
 --> /Users/huangyingjie/Rprojects/new_demo/src/main.rs:4:5
  |
2 |     let x = 1;
  |         -
  |         |
  |         first assignment to `x`
  |         help: consider making this binding mutable: `mut x`
3 |     println!("The value of x is: {}", x);
4 |     x = 2;
  |     ^^^^^ cannot assign twice to immutable variable

error: aborting due to previous error
```

éŒ¯çš„åŸå› æ˜¯cannot assign twice to immutable x(ç„¡æ³•å°ä¸å¯è®Šçš„è®Šæ•¸é€²è¡Œé‡è¤‡è³¦å€¼)ï¼Œå› ç‚ºæˆ‘å€‘æƒ³å°ä¸å¯è®Šçš„xè®Šæ•¸å†æ¬¡è³¦å€¼ã€‚

åœ¨Rustä¸­ï¼Œå¯è®Šæ€§å¾ˆç°¡å–®ï¼Œåªè¦åœ¨è®Šæ•¸å‰åŠ ä¸€å€‹mutå°±å¯ã€‚

ç‚ºäº†è®“è®Šæ•¸ç‚ºå¯è®Šï¼Œå¯æ”¹ç‚º:

{% highlight Rust %}

fn main(){
  let mut x = 1;
  printl!("The value of x is: {}",x);
  x = 2;
  println!("The value of x is: {}", x);
}

{% endhighlight %}

```
:!'/var/folders/mg/1r752ql131v0n4nfn43j2xdc0000gn/T/nvim.huangyingjie/mKXpmr/1/main'
The value of x is: 1
The value of x is: 2
```
### ä½¿ç”¨ä¸‹åº•ç·šé–‹é ­å¿½ç•¥æœªä½¿ç”¨è®Šæ•¸

ç•¶ä½ å‰µå»ºäº†ä¸€å€‹è®Šæ•¸å»æœªä½¿ç”¨å®ƒï¼ŒRustæœƒçµ¦ä½ è­¦å‘Šã€‚ä½†æœ‰æ™‚å‰µå»ºä¸€å€‹ä¸æœƒè¢«ä½¿ç”¨çš„è®Šæ•¸æ˜¯æœ‰ç”¨çš„ï¼Œæ¯”å¦‚æ­£åœ¨è¨­è¨ˆä¸€å€‹åŸå½¢æˆ–å‰›é–‹å§‹ä¸€å€‹é …ç›®ã€‚é€™æ™‚ä½ å¸Œæœ›Rustä¸è¦è­¦å‘Šæœªä½¿ç”¨çš„è®Šæ•¸ï¼Œç‚ºæ­¤å¯ä»¥ç”¨ä¸‹åº•ç·šä½œç‚ºè®Šæ•¸çš„é–‹é ­:

{% highlight rust %}

fn main(){
  let _x = 1;
  let y = 2;
}

{% endhighlight %}

> cargo run
  warning: unused variable: `y`
   --> src/main.rs:3:9
    |
  3 |     let y = 2;
    |         ^ help: if this is intentional, prefix it with an underscore: `_y`
    |
    = note: `#[warn(unused_variables)]` on by default

### è®Šæ•¸è§£æ§‹

åœ¨Rust 1.59å¾Œï¼Œæˆ‘å€‘å¯åœ¨è³¦å€¼å¥çš„å·¦å¼ä¸­ä½¿ç”¨å…ƒçµ„,åˆ‡ç‰‡å’Œçµæ§‹é«”æ¨¡å¼ã€‚
{% highlight rust %}

struct Struct {
  e:i32
}
fn main(){
  let (a,b,c,d,e);

  (a, b) = (1, 2);
  [c, .., d, _] = [1, 2, 3, 4, 5];
  Struct {e, .. } = Struct {e: 5};

  assert_eq!([1, 2, 3, 4, 5], [a, b, c, d, e]);
}

{% endhighlight %}

é€™æ–¹æ³•è·Ÿä¹‹å‰çš„letä¿æŒäº†ä¸€è‡´æ€§ï¼Œä½†æ˜¯letæœƒé‡æ–°ç¶å®šï¼Œè€Œé€™è£¡åªæ˜¯å°ä¹‹å‰ç¶å®šçš„è®Šæ•¸é€²è¡Œå†è³¦å€¼ã€‚

éœ€æ³¨æ„çš„æ˜¯ï¼Œä½¿ç”¨ += çš„è³¦å€¼èªå¥é‚„ä¸æ”¯æŒè§£æ§‹å¼è³¦å€¼ã€‚

### è®Šæ•¸å’Œå¸¸æ•¸ä¹‹é–“çš„å·®ç•°

å¸¸æ•¸(constant) èˆ‡ä¸å¯è®Šæ•¸ä¸€æ¨£ï¼Œå¸¸æ•¸ä¹Ÿæ˜¯ç¶å®šåˆ°ä¸€å€‹å¸¸æ•¸åä¸”ä¸å…è¨±æ›´æ”¹çš„å€¼ï¼Œä½†æ˜¯å¸¸æ•¸å’Œè®Šæ•¸é‚„æ˜¯å­˜åœ¨ä¸€äº›å·®ç•°:

ğŸ§ª å¸¸æ•¸ä¸å…è¨±ä½¿ç”¨mutã€‚å¸¸æ•¸ä¸åƒ…é»˜èªä¸å¯è®Šï¼Œè€Œä¸”è‡ªå§‹è‡³çµ‚ä¸å¯è®Šï¼Œå› ç‚ºåœ¨ç·¨è­¯å®Œæˆå¾Œå·²ç¶“ç¢ºå®šå®ƒçš„å€¼ã€‚

ğŸ§ª å¸¸æ•¸ä½¿ç”¨consté—œéµå­—è€Œä¸æ˜¯letï¼Œä¸¦ä¸”å€¼çš„é¡å‹å¿…é ˆæ¨™è¨»ã€‚

ä¸‹é¢ç¯„ä¾‹ï¼Œå¸¸æ•¸åç‚ºMAX_POINTSï¼Œå€¼è¨­ç½®ç‚º100000ã€‚(Rustå¸¸æ•¸çš„å‘½åç´„å®šæ˜¯å…¨éƒ¨éƒ½ä½¿ç”¨å¤§å¯«ï¼Œä¸¦ä½¿ç”¨ä¸‹åº•ç·šåˆ†éš”å–®è©ï¼Œå¦å°æ•¸å­—å­—é¢é‡å¯æ’å…¥ä¸‹åº•ç·šä»¥æé«˜å¯è®€æ€§):

  const MAX_POINTS: u43 = 100_000;

å¸¸æ•¸å¯ä»¥å†ä»»æ„ä½œç”¨åŸŸå…§è²æ˜ï¼ŒåŒ…æ‹¬å…¨å±€ä½œç”¨åŸŸï¼Œåœ¨è²æ˜çš„ä½œç”¨åŸŸå…§ï¼Œå¸¸æ•¸åœ¨ç¨‹å¼é‹è¡Œæ•´å€‹éç¨‹éƒ½æœ‰æ•ˆã€‚å°æ–¼éœ€è¦å†å¤šç–Šä»£ç¢¼å…±äº«ä¸€å€‹ä¸å¯è®Šçš„å€¼æ™‚éå¸¸æœ‰ç”¨ã€‚

### è®Šæ•¸é®è”½(shadowing)

Rustå…è¨±è²æ˜ç›¸åŒçš„è®Šæ•¸åï¼Œåœ¨å¾Œé¢è²æ˜çš„è®Šæ•¸æˆ–é®è”½èª¿å‰é¢çš„è²æ˜:

{% highlight rust %}

fn main(){
  let x = 1;
  // åœ¨mainå‡½æ•¸çš„ä½œç”¨åŸŸå…§å°ä¹‹å‰çš„xé€²è¡Œé®è”½
  let x = x + 1;

  {
    // åœ¨ç•¶å‰çš„æ‹¬è™Ÿä½œç”¨åŸŸå…§ï¼Œå°ä¹‹å‰çš„xé€²è¡Œé®è”½
    let x = x * 2;
    println!("The value of x in the inner scope isL {}", x);
  }
  println!("The value of x is: {}", x);
}

{% endhighlight %}

é€™æ˜¯å…ˆå°‡å€¼5ç¶å®šåˆ°xï¼Œé€šéé‡è¤‡ä½¿ç”¨let x = ä¾†é®è”½ä¹‹å‰çš„xï¼Œä¸¦å–åŸä¾†çš„å€¼åŠ ä¸Š1ï¼Œæ‰€ä»¥xçš„å€¼è®Šæˆäº†2ã€‚

The value of x in the inner scope is: 4
The value of x is: 2

é€™å’Œmutè®Šæ•¸çš„ä½¿ç”¨æ˜¯ä¸åŒçš„ï¼Œç¬¬äºŒå€‹letç”Ÿæˆäº†å®Œå…¨ä¸åŒçš„æ–°è®Šæ•¸ï¼Œå…©å€‹è®Šæ•¸åªæ˜¯å‰›å¥½æœ‰åŒæ¨£çš„åç¨±ï¼Œmutè²æ˜çš„è®Šæ•¸ï¼Œå¯ä»¥ä¿®æ”¹åŒä¸€å€‹åœ°å€ä¸Šçš„å€¼ï¼Œä¸¦ä¸æœƒç™¼ç”Ÿå…§å­˜å°è±¡çš„å†æ¬¡åˆ†é…ï¼Œæ€§èƒ½è¦æ›´å¥½ã€‚

è®Šæ•¸é®è”½çš„ç”¨è™•åœ¨äºï¼Œå¦‚æœä½ åœ¨æŸå€‹ä½œç”¨åŸŸå…§ç„¡éœ€å†ä½¿ç”¨ä¹‹å‰çš„è®Šæ•¸(å†è¢«é®è”½å¾Œï¼Œç„¡æ³•åœ¨è¨ªå•åˆ°ä¹‹å‰çš„åŒåè®Šæ•¸)ï¼Œå°±å¯ä»¥é‡è¤‡çš„ä½¿ç”¨è®Šæ•¸åå­—ã€‚

å‡è¨­æœ‰ä¸€å€‹ç¨‹å¼è¦çµ±è¨ˆä¸€å€‹ç©ºæ ¼å­—ç¬¦ä¸²å¾—ç©ºæ ¼æ•¸é‡:

  // å­—ç¬¦ä¸²é¡å‹
  let spaces = "  ";
  // usizeæ•¸å€¼é¡å‹
  let spaces = spaces.len();

é€™å€‹æ¶æ§‹æ˜¯å…è¨±çš„ï¼Œå› ç‚ºç¬¬ä¸€å€‹spacesè®Šæ•¸æ˜¯ä¸€å€‹å­—ç¬¦ä¸²é¡å‹ï¼Œç¬¬äºŒå€‹spacesè®Šæ•¸æ˜¯ä¸€å€‹å…¨æ–°çš„è®Šæ•¸ä¸”å’Œç¬¬ä¸€å€‹å…·æœ‰ç›¸åŒçš„è®Šæ•¸åï¼Œä¸”æ˜¯ä¸€å€‹æ•¸å€¼é¡å‹ã€‚

å¦‚æœä¸ç”¨let:

    let mut spaces = "  ";
    spaces = spaces.len();


    error[E0308]: mismatched types
     --> src/main.rs:3:14
      |
    3 |     spaces = spaces.len();
      |              ^^^^^^^^^^^^ expected `&str`, found `usize`

    error: aborting due to previous error

é¡¯ç„¶Rustå°æ–¼é¡å‹è¦æ±‚å¾ˆåš´æ ¼ï¼Œä¸å…è¨±å°‡æ•´æ•¸é¡å‹usizeè³¦å€¼çµ¦å­—ç¬¦ä¸²é¡å‹ã€‚usizeæ˜¯ä¸€ç¨®CPUç›¸é—œçš„æ•´æ•¸é¡å‹ã€‚


